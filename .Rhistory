for(iff in ff) rmarkdown::render(iff)
setwd("C:/Users/mbrxsmbc/Documents/Thesis/index/")
}
knit_to_Google <- function(.file,output=F)
{
setwd("C:/Users/mbrxsmbc/Documents/Thesis/index/")
if(is.numeric(.file))
{
if(.file <10) .file <- paste0("0",.file) else .file <- paste0(.file)
ff <- list.files()
.file <- ff[grep(.file,ff)]
}
knit_chapter(.file,"word")
file.title <- gsub("_"," ",gsub(".Rmd","",gsub("^[0-9][0-9]-","",.file)),fixed=T)
file.docx <- paste0("Chapters/",gsub(".Rmd",".pdf",.file))
if(nrow(drive_find(file.title))==0)
{
drib <- drive_upload(media=file.docx,path="Thesis",name=file.title,type="document")
cat("\nNew File Created (sharing may be not be active)")
} else {
drib <- drive_update(file=file.title,media=file.docx)
cat("\nUpdated file on Google Docs")
}
cat("\n\nShareable Link for ",file.title,":\n\t",
"https://docs.google.com/document/d/",drib$id,"/edit?usp=sharing",sep="")
setwd("C:/Users/mbrxsmbc/Documents/Thesis/index/")
if(output) return(drib)
}
knit_all_Google <- function()
{
ff <- list.files()
ff <- ff[grep("^[0-9]",ff)]
ff <- ff[-grep("^(00|99)",ff)]
docs <- map_dfr(ff,knit_to_Google,output=T)
return(docs)
}
knit_chapter(6,"word")
write_chapter_rmd <- function(.file,output="pdf")
{
setwd("C:/Users/mbrxsmbc/Documents/Thesis/index/")
if(is.numeric(.file))
{
if(.file <10) .file <- paste0("0",.file) else .file <- paste0(.file)
ff <- list.files()
.file <- ff[grep(.file,ff)]
}
rmd <- readLines(.file)
title <- rmd[grep("^# ",rmd[1:3])]
title <- substring(title,1,regexpr("{",title,fixed=T)[[1]]-1)
title <- trimws(gsub("#","",title,fixed=T))
title <- paste0("title: ",title)
if(output == "pdf")
{
output.header <- c("output:",
"  bookdown::pdf_document2")
} else if(output=="word")
{
output.header <- c("output:",
"  bookdown::word_document2:",
"    reference_docx: \"Ref.docx\"")
} else
{
output.header <- c("output:",
paste0("  bookdown::",output))
}
header <- c(
"---",
title,
"bibliography: ../bib/thesis.bib",
"csl: ../csl/ieee.csl",
"number_sections: true",
output.header,
"---",
"```{r setup, include=F}",
"source(\"../setup.R\")",
"```",
"\\include{latex_commands.txt}",
"<style>",
"caption {",
"  display: table-caption;",
"  text-align: center;",
"}",
"</style>"
)
rmd <- rmd[-grep("^# ",rmd[1:3])]
rmd <- gsub("^#","",rmd)
rmd <- c(header,rmd,"","# References","")
writeLines(rmd,paste0("Chapters/",.file))
}
knit_chapter(6,"word")
knit_chapter(6,"word")
knit_chapter(6,"word")
knit_to_Google(6)
write_chapter_rmd <- function(.file,output="pdf")
{
setwd("C:/Users/mbrxsmbc/Documents/Thesis/index/")
if(is.numeric(.file))
{
if(.file <10) .file <- paste0("0",.file) else .file <- paste0(.file)
ff <- list.files()
.file <- ff[grep(.file,ff)]
}
rmd <- readLines(.file)
title <- rmd[grep("^# ",rmd[1:3])]
title <- substring(title,1,regexpr("{",title,fixed=T)[[1]]-1)
title <- trimws(gsub("#","",title,fixed=T))
title <- paste0("title: ",title)
if(output == "pdf")
{
output.header <- c("output:",
"  bookdown::pdf_document2")
} else if(output=="word")
{
output.header <- c("output:",
"  bookdown::word_document2:",
"    reference_docx: Ref.docx")
} else
{
output.header <- c("output:",
paste0("  bookdown::",output))
}
header <- c(
"---",
title,
"bibliography: ../bib/thesis.bib",
"csl: ../csl/ieee.csl",
"number_sections: true",
output.header,
"---",
"```{r setup, include=F}",
"source(\"../setup.R\")",
"```",
"\\include{latex_commands.txt}",
"<style>",
"caption {",
"  display: table-caption;",
"  text-align: center;",
"}",
"</style>"
)
rmd <- rmd[-grep("^# ",rmd[1:3])]
rmd <- gsub("^#","",rmd)
rmd <- c(header,rmd,"","# References","")
writeLines(rmd,paste0("Chapters/",.file))
}
knit_chapter <- function(.file,output="pdf")
{
setwd("C:/Users/mbrxsmbc/Documents/Thesis/index/")
if(is.numeric(.file))
{
if(.file <10) .file <- paste0("0",.file) else .file <- paste0(.file)
ff <- list.files()
.file <- ff[grep(.file,ff)]
}
write_chapter_rmd(.file,output)
setwd("C:/Users/mbrxsmbc/Documents/Thesis/index/Chapters")
rmarkdown::render(.file)
setwd("C:/Users/mbrxsmbc/Documents/Thesis/index/")
}
knit_all_chapters <- function(output="pdf")
{
ff <- list.files()
ff <- ff[grep("^[0-9]",ff)]
ff <- ff[-grep("^(00|99)",ff)]
for(iff in ff) write_chapter_rmd(iff,output)
setwd("C:/Users/mbrxsmbc/Documents/Thesis/index/Chapters")
for(iff in ff) rmarkdown::render(iff)
setwd("C:/Users/mbrxsmbc/Documents/Thesis/index/")
}
knit_to_Google <- function(.file,output=F)
{
setwd("C:/Users/mbrxsmbc/Documents/Thesis/index/")
if(is.numeric(.file))
{
if(.file <10) .file <- paste0("0",.file) else .file <- paste0(.file)
ff <- list.files()
.file <- ff[grep(.file,ff)]
}
knit_chapter(.file,"word")
file.title <- gsub("_"," ",gsub(".Rmd","",gsub("^[0-9][0-9]-","",.file)),fixed=T)
file.docx <- paste0("Chapters/",gsub(".Rmd",".pdf",.file))
if(nrow(drive_find(file.title))==0)
{
drib <- drive_upload(media=file.docx,path="Thesis",name=file.title,type="document")
cat("\nNew File Created (sharing may be not be active)")
} else {
drib <- drive_update(file=file.title,media=file.docx)
cat("\nUpdated file on Google Docs")
}
cat("\n\nShareable Link for ",file.title,":\n\t",
"https://docs.google.com/document/d/",drib$id,"/edit?usp=sharing",sep="")
setwd("C:/Users/mbrxsmbc/Documents/Thesis/index/")
if(output) return(drib)
}
knit_all_Google <- function()
{
ff <- list.files()
ff <- ff[grep("^[0-9]",ff)]
ff <- ff[-grep("^(00|99)",ff)]
docs <- map_dfr(ff,knit_to_Google,output=T)
return(docs)
}
write_chapter_rmd <- function(.file,output="pdf")
{
setwd("C:/Users/mbrxsmbc/Documents/Thesis/index/")
if(is.numeric(.file))
{
if(.file <10) .file <- paste0("0",.file) else .file <- paste0(.file)
ff <- list.files()
.file <- ff[grep(.file,ff)]
}
rmd <- readLines(.file)
title <- rmd[grep("^# ",rmd[1:3])]
title <- substring(title,1,regexpr("{",title,fixed=T)[[1]]-1)
title <- trimws(gsub("#","",title,fixed=T))
title <- paste0("title: ",title)
if(output == "pdf")
{
output.header <- c("output:",
"  bookdown::pdf_document2")
} else if(output=="word")
{
output.header <- c("output:",
"  bookdown::word_document2:",
"    reference_docx: Ref.docx")
} else
{
output.header <- c("output:",
paste0("  bookdown::",output))
}
header <- c(
"---",
title,
"bibliography: ../bib/thesis.bib",
"csl: ../csl/ieee.csl",
"number_sections: true",
output.header,
"---",
"```{r setup, include=F}",
"source(\"../setup.R\")",
"```",
"\\include{latex_commands.txt}",
"<style>",
"caption {",
"  display: table-caption;",
"  text-align: center;",
"}",
"</style>"
)
rmd <- rmd[-grep("^# ",rmd[1:3])]
rmd <- gsub("^#","",rmd)
rmd <- c(header,rmd,"","# References","")
writeLines(rmd,paste0("Chapters/",.file))
}
knit_chapter <- function(.file,output="pdf")
{
setwd("C:/Users/mbrxsmbc/Documents/Thesis/index/")
if(is.numeric(.file))
{
if(.file <10) .file <- paste0("0",.file) else .file <- paste0(.file)
ff <- list.files()
.file <- ff[grep(.file,ff)]
}
write_chapter_rmd(.file,output)
setwd("C:/Users/mbrxsmbc/Documents/Thesis/index/Chapters")
rmarkdown::render(.file)
setwd("C:/Users/mbrxsmbc/Documents/Thesis/index/")
}
knit_all_chapters <- function(output="pdf")
{
ff <- list.files()
ff <- ff[grep("^[0-9]",ff)]
ff <- ff[-grep("^(00|99)",ff)]
for(iff in ff) write_chapter_rmd(iff,output)
setwd("C:/Users/mbrxsmbc/Documents/Thesis/index/Chapters")
for(iff in ff) rmarkdown::render(iff)
setwd("C:/Users/mbrxsmbc/Documents/Thesis/index/")
}
knit_to_Google <- function(.file,out=F)
{
setwd("C:/Users/mbrxsmbc/Documents/Thesis/index/")
if(is.numeric(.file))
{
if(.file <10) .file <- paste0("0",.file) else .file <- paste0(.file)
ff <- list.files()
.file <- ff[grep(.file,ff)]
}
knit_chapter(.file,"word")
file.title <- gsub("_"," ",gsub(".Rmd","",gsub("^[0-9][0-9]-","",.file)),fixed=T)
file.docx <- paste0("Chapters/",gsub(".Rmd",".pdf",.file))
if(nrow(drive_find(file.title))==0)
{
drib <- drive_upload(media=file.docx,path="Thesis",name=file.title,type="document")
cat("\nNew File Created (sharing may be not be active)")
} else {
drib <- drive_update(file=file.title,media=file.docx)
cat("\nUpdated file on Google Docs")
}
cat("\n\nShareable Link for ",file.title,":\n\t",
"https://docs.google.com/document/d/",drib$id,"/edit?usp=sharing",sep="")
setwd("C:/Users/mbrxsmbc/Documents/Thesis/index/")
if(out) return(drib)
}
knit_all_Google <- function()
{
ff <- list.files()
ff <- ff[grep("^[0-9]",ff)]
ff <- ff[-grep("^(00|99)",ff)]
docs <- map_dfr(ff,knit_to_Google,out=T)
return(docs)
}
knit_to_Google(6)
write_chapter_rmd <- function(.file,output="pdf")
{
setwd("C:/Users/mbrxsmbc/Documents/Thesis/index/")
if(is.numeric(.file))
{
if(.file <10) .file <- paste0("0",.file) else .file <- paste0(.file)
ff <- list.files()
.file <- ff[grep(.file,ff)]
}
rmd <- readLines(.file)
title <- rmd[grep("^# ",rmd[1:3])]
title <- substring(title,1,regexpr("{",title,fixed=T)[[1]]-1)
title <- trimws(gsub("#","",title,fixed=T))
title <- paste0("title: ",title)
if(output == "pdf")
{
output.header <- c("output:",
"  bookdown::pdf_document2")
} else if(output=="word")
{
output.header <- c("output:",
"  bookdown::word_document2:",
"    reference_docx: Ref.docx")
} else
{
output.header <- c("output:",
paste0("  bookdown::",output))
}
header <- c(
"---",
title,
"bibliography: ../bib/thesis.bib",
"csl: ../csl/ieee.csl",
"number_sections: true",
output.header,
"---",
"```{r setup, include=F}",
"source(\"../setup.R\")",
"```",
"\\include{latex_commands.txt}",
"<style>",
"caption {",
"  display: table-caption;",
"  text-align: center;",
"}",
"</style>"
)
rmd <- rmd[-grep("^# ",rmd[1:3])]
rmd <- gsub("^#","",rmd)
rmd <- c(header,rmd,"","# References","")
writeLines(rmd,paste0("Chapters/",.file))
}
knit_chapter <- function(.file,output="pdf")
{
setwd("C:/Users/mbrxsmbc/Documents/Thesis/index/")
if(is.numeric(.file))
{
if(.file <10) .file <- paste0("0",.file) else .file <- paste0(.file)
ff <- list.files()
.file <- ff[grep(.file,ff)]
}
write_chapter_rmd(.file,output)
setwd("C:/Users/mbrxsmbc/Documents/Thesis/index/Chapters")
rmarkdown::render(.file)
setwd("C:/Users/mbrxsmbc/Documents/Thesis/index/")
}
knit_all_chapters <- function(output="pdf")
{
ff <- list.files()
ff <- ff[grep("^[0-9]",ff)]
ff <- ff[-grep("^(00|99)",ff)]
for(iff in ff) write_chapter_rmd(iff,output)
setwd("C:/Users/mbrxsmbc/Documents/Thesis/index/Chapters")
for(iff in ff) rmarkdown::render(iff)
setwd("C:/Users/mbrxsmbc/Documents/Thesis/index/")
}
knit_to_Google <- function(.file,out=F)
{
setwd("C:/Users/mbrxsmbc/Documents/Thesis/index/")
if(is.numeric(.file))
{
if(.file <10) .file <- paste0("0",.file) else .file <- paste0(.file)
ff <- list.files()
.file <- ff[grep(.file,ff)]
}
knit_chapter(.file,"word")
file.title <- gsub("_"," ",gsub(".Rmd","",gsub("^[0-9][0-9]-","",.file)),fixed=T)
file.docx <- paste0("Chapters/",gsub(".Rmd",".docx",.file))
if(nrow(drive_find(file.title))==0)
{
drib <- drive_upload(media=file.docx,path="Thesis",name=file.title,type="document")
cat("\nNew File Created (sharing may be not be active)")
} else {
drib <- drive_update(file=file.title,media=file.docx)
cat("\nUpdated file on Google Docs")
}
cat("\n\nShareable Link for ",file.title,":\n\t",
"https://docs.google.com/document/d/",drib$id,"/edit?usp=sharing",sep="")
setwd("C:/Users/mbrxsmbc/Documents/Thesis/index/")
if(out) return(drib)
}
knit_all_Google <- function()
{
ff <- list.files()
ff <- ff[grep("^[0-9]",ff)]
ff <- ff[-grep("^(00|99)",ff)]
docs <- map_dfr(ff,knit_to_Google,out=T)
return(docs)
}
knit_to_Google(6)
knit_chapter(6,"word")
knit_to_Google(6)
knit_to_Google(6)
knit_to_Google(6)
knit_to_Google(6)
knit_to_Google(6)
knit_to_Google(6)
knit_to_Google(6)
knit_to_Google(6)
knit_to_Google(6)
knit_to_Google(6)
knit_to_Google(6)
knit_to_Google(6)
paste0(.wd,"data/Dev_Paper_Categorical_Demographics.csv") %>%
read_csv(col_types=cols()) %>%
flextable %>%
set_header_labels(res_SKS = "SKS (Development)",
res_UoG = "SERPR (Validation)") %>%
fontsize(size=8) %>%
font(part="all",font="Garamond") %>%
padding(padding=0) %>%
fontsize(j=2:3,size=7) %>%
align(j=1,align="left") %>%
#fontsize(size=7,part="footer") %>%
font(j=2:3,font="courier new") %>%
align(j=2:3,align="right") %>%
width(j=2:3,width=3.5)
add_flextable_caption("Categorical-Demo","Population demographics for the categorical variables presented as number (percent)")
paste0(.wd,"data/Dev_Paper_Categorical_Demographics.csv") %>%
read_csv(col_types=cols()) %>%
flextable %>%
set_header_labels(res_SKS = "SKS (Development)",
res_UoG = "SERPR (Validation)") %>%
fontsize(size=8) %>%
font(part="all",font="Garamond") %>%
padding(padding=0) %>%
fontsize(j=2:3,size=7) %>%
align(j=1,align="left") %>%
#fontsize(size=7,part="footer") %>%
font(j=2:3,font="courier new") %>%
align(j=2:3,align="right") %>%
autofit()
add_flextable_caption("Categorical-Demo","Population demographics for the categorical variables presented as number (percent)")
paste0(.wd,"data/Dev_Paper_Comorbidity_Demographics.csv") %>%
read_csv(col_types=cols()) %>%
flextable %>%
set_header_labels(res_SKS = "SKS (Development)",
res_UoG = "SERPR (Validation)") %>%
fontsize(size=8) %>%
font(part="all",font="Garamond") %>%
padding(padding=0) %>%
fontsize(j=2:3,size=7) %>%
align(j=1,align="left") %>%
#fontsize(size=7,part="footer") %>%
font(j=2:3,font="courier new") %>%
align(j=2:3,align="right") %>%
width(j=2:3,width=3.5)
add_flextable_caption("Comorbidity-Demo","Population comorbidity prevalence for the two populations presented as number (percent) <number missing (percent missing)>")
paste0(.wd,"data/Dev_Paper_Comorbidity_Demographics.csv") %>%
read_csv(col_types=cols()) %>%
flextable %>%
set_header_labels(res_SKS = "SKS (Development)",
res_UoG = "SERPR (Validation)") %>%
fontsize(size=8) %>%
font(part="all",font="Garamond") %>%
padding(padding=0) %>%
fontsize(j=2:3,size=7) %>%
align(j=1,align="left") %>%
#fontsize(size=7,part="footer") %>%
font(j=2:3,font="courier new") %>%
align(j=2:3,align="right") %>%
auofit()
paste0(.wd,"data/Dev_Paper_Comorbidity_Demographics.csv") %>%
read_csv(col_types=cols()) %>%
flextable %>%
set_header_labels(res_SKS = "SKS (Development)",
res_UoG = "SERPR (Validation)") %>%
fontsize(size=8) %>%
font(part="all",font="Garamond") %>%
padding(padding=0) %>%
fontsize(j=2:3,size=7) %>%
align(j=1,align="left") %>%
#fontsize(size=7,part="footer") %>%
font(j=2:3,font="courier new") %>%
align(j=2:3,align="right") %>%
autofit()
add_flextable_caption("Comorbidity-Demo","Population comorbidity prevalence for the two populations presented as number (percent) <number missing (percent missing)>")
knit_to_Google(6)
knit_to_Google(6)
knit_to_Google(6)
